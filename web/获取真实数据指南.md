# 智能头盔监控系统 - 获取真实数据指南

## 当前状态

- ✅ 设备数据已成功上传到华为云
- ✅ 前端界面已完成
- ❌ 前端显示的是模拟数据

## 获取真实数据的三种方案

### 方案1：使用华为云数据转发（推荐）⭐

这是最简单的方案，不需要配置访问密钥。

#### 步骤：

1. **登录华为云IoT平台**
   - 访问：https://console.huaweicloud.com/iotdm/?region=cn-north-4

2. **创建数据转发规则**
   - 进入：规则引擎 → 数据转发
   - 点击：创建规则
   - 规则名称：helmet_data_forward
   - 触发条件：设备属性上报
   - 选择产品：你的智能头盔产品
   - 选择设备：Helmet_01

3. **配置转发目标**
   - 转发类型：HTTP/HTTPS
   - URL：http://你的电脑IP:5000/api/data
   - 方法：POST
   - 内容类型：application/json

4. **启动后端服务器**
   ```bash
   python backend_local.py
   ```

5. **测试**
   - 设备上报数据后，后端会自动接收
   - 前端会实时显示真实数据

#### 优点：
- ✅ 配置简单，不需要访问密钥
- ✅ 实时推送，延迟低
- ✅ 自动处理，无需轮询

#### 缺点：
- ❌ 需要电脑有公网IP或内网穿透
- ❌ 华为云免费版可能有限制

---

### 方案2：使用模拟数据（当前方案）

如果暂时无法配置数据转发，可以继续使用模拟数据进行界面开发和测试。

#### 使用方法：
```bash
python backend.py
```

访问 http://localhost:5000 查看效果。

---

### 方案3：使用华为云REST API（需要配置）

需要配置华为云访问密钥（AK/SK），适合生产环境。

#### 步骤：

1. **获取访问密钥**
   - 访问：https://console.huaweicloud.com/iam/?region=cn-north-4#/mine/accessKey
   - 点击：新增访问密钥
   - 下载并保存 AK 和 SK

2. **配置后端**
   - 编辑 `backend_real.py`
   - 填入你的 AK 和 SK

3. **启动后端**
   ```bash
   python backend_real.py
   ```

#### 优点：
- ✅ 安全可靠
- ✅ 适合生产环境
- ✅ 可以获取历史数据

#### 缺点：
- ❌ 配置复杂
- ❌ 需要管理访问密钥

---

## 推荐方案

### 开发阶段
使用**方案2（模拟数据）**进行界面开发和测试。

### 演示阶段
使用**方案1（数据转发）**展示真实数据。

### 生产阶段
使用**方案3（REST API）**确保安全性和稳定性。

---

## 快速开始

### 如果你想立即看到真实数据：

1. **最简单的方法**：使用华为云数据转发
   - 在华为云控制台配置数据转发规则
   - 转发到 http://你的IP:5000/api/data
   - 运行 `python backend_local.py`

2. **如果无法配置数据转发**：
   - 继续使用 `python backend.py`（模拟数据）
   - 等待后续配置华为云访问密钥

---

## 文件说明

- `backend.py` - 模拟数据版本（当前使用）
- `backend_local.py` - 本地数据接收版本（需要数据转发）
- `backend_real.py` - 华为云API版本（需要AK/SK）

---

## 常见问题

### Q: 为什么不能直接从华为云获取数据？
A: 设备侧MQTT账号只能发布数据，不能订阅。需要使用应用侧账号或REST API。

### Q: 数据转发需要公网IP吗？
A: 是的。如果没有公网IP，可以使用内网穿透工具（如ngrok、frp）。

### Q: 模拟数据和真实数据有什么区别？
A: 模拟数据是随机生成的，真实数据来自你的智能头盔设备。

---

## 技术支持

如有问题，请检查：
1. 华为云数据转发规则是否正确配置
2. 后端服务器是否正常运行
3. 防火墙是否允许5000端口
4. 设备是否正常上报数据到华为云
